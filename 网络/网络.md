请描述一次网络请求？

首先基于网络的分层协议，通过DNS解析获得目标的ip地址，首先是**应用层**包装http包体，其中有请求行、请求头、请求体，然后将这个包结构交给**传输层**，传输层在http的包体上继续添加tcp/udp层要使用的自己的端口和目标的端口，紧接着是**网络层**会添加上自己的ip地址和网关ip，最后是操作系统了解了ip地址之后，会通过子网掩码判断该ip是否在本地的子网中，如果在直接发送请求，如果不在，会通过ARP协议（广播）在本地子网里由网关的ip搜索找到网关对应的mac地址，并将请求发送给网关，再由网关转发请求到外部，而这种由一个网关发送给另一台服务器的网关的方式需要路由规则（路由表）的辅助。